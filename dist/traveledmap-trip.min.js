"use strict";function e(){return(e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}var t=function(e,t){null!==t?history.pushState({},"","#"+t):history.pushState({},"",window.location.pathname+window.location.search),e&&e.contentWindow?e.contentWindow.postMessage({type:"parentWindowHashChanged",detail:{hash:t||null}},"*"):console.warn("[TraveledMap trip] iframe or iframe contentWindow is null")},n={isDisabled:!1,isSticky:!1,isExtendable:!1,isStretchable:!1,mapHeight:"30VH",stickyMapHeight:"30VH",stretchedMapHeight:"50VH",stickyMarginTop:10,shouldExtendToTop:!1,shouldExtendToRight:!1,shouldExtendToBottom:!1,shouldExtendToLeft:!1,marginTop:15,marginRight:15,marginBottom:15,marginLeft:15,shouldShowMarkersCustomization:!1,shouldShowPictures:!0,shouldShowPicturesAtStart:!1,shouldShowOnPhones:!0,shouldShowOnTablets:!0,shouldShowOnLargeScreens:!0,shouldShowSteps:!1,shouldShowStepsWhenExtended:!1,shouldShowStepsWhenStretched:!1,shouldShowPicturesWhenExtended:!1,shouldShowPicturesWhenStretched:!1,isOverContent:!1,shouldScrollToStepContentWhenClicked:!0},i=function(){function i(i,a){var o=this;this.mapContainerEl=null,this.mapSubcontainerEl=null,this.mapIframeEl=null,this.isExtended=!1,this.scrollConfig={shouldListenToScroll:!0,currentHash:null,isScrollingDown:!0,previousScrollDistance:0},this.createSticky=function(){o.config.isSticky&&(o.stickyEl?o.stickyEl.enable():o.stickyEl=new Sticky("#"+o.mapContainerId+" .traveledmap-trip-widget-map-container",{wrap:!0,stickyClass:"is--sticky",marginTop:o.config.stickyMarginTop}))},this.listenToExtendMapToggling=function(){document.addEventListener("traveledmapTripToggleExtendMap",(function(e){e.detail===o.mapContainerId&&o.mapContainerEl&&(o.isExtended?o.effectivelyReduceMap():o.effectivelyExtendMap())}))},this.listenToStretchMapToggling=function(){document.addEventListener("traveledmapTripToggleStretchMap",(function(e){e.detail===o.mapContainerId&&o.mapSubcontainerEl&&(o.mapSubcontainerEl.classList.contains("is--stretched")?(o.mapSubcontainerEl.classList.remove("is--stretched"),o.sendResizeEvent("mapHasBeenReduced")):(o.mapSubcontainerEl.classList.add("is--stretched"),o.sendResizeEvent("mapHasBeenExtended",o.config.shouldShowStepsWhenStretched,o.config.shouldShowPicturesWhenStretched)))}))},this.listenToHideMapToggling=function(){document.addEventListener("traveledmapTripToggleHideMap",(function(e){e.detail===o.mapContainerId&&o.mapSubcontainerEl&&(o.mapSubcontainerEl.classList.contains("is--hidden")?o.mapSubcontainerEl.classList.remove("is--hidden"):o.mapSubcontainerEl.classList.add("is--hidden"))}))},this.effectivelyReduceMap=function(){o.setMapToReducedSize(),o.isExtended=!1,o.sendResizeEvent("mapHasBeenReduced"),o.createSticky()},this.effectivelyExtendMap=function(){o.stickyEl&&o.stickyEl.disable(),o.setMapSizeToExtendedSize(),o.isExtended=!0,o.sendResizeEvent("mapHasBeenExtended",o.config.shouldShowStepsWhenExtended,o.config.shouldShowPicturesWhenExtended)},this.setMapToReducedSize=function(){o.mapSubcontainerEl?(o.mapSubcontainerEl.style.position="relative",o.mapSubcontainerEl.style.top="auto",o.mapSubcontainerEl.style.right="auto",o.mapSubcontainerEl.style.bottom="auto",o.mapSubcontainerEl.style.left="auto",o.mapSubcontainerEl.style.height=o.config.mapHeight||"100px",o.mapSubcontainerEl.style.width="auto"):console.warn("[TraveledMap trip] subcontainer is null")},this.setMapSizeToExtendedSize=function(){if(o.mapSubcontainerEl){var e=o.mapSubcontainerEl.getBoundingClientRect(),t=window.innerWidth,n=window.innerHeight,i=o.config,a=i.shouldExtendToTop,s=i.shouldExtendToRight,l=i.shouldExtendToBottom,r=i.shouldExtendToLeft,c=o.config.marginTop||0,d=o.config.marginRight||0,h=o.config.marginLeft||0,p=(o.config.marginBottom||0)+40,u=e.height-(c+p),g=e.width-(h+d);o.mapSubcontainerEl.style.position="fixed",a&&(o.mapSubcontainerEl.style.top=c+"px",u+=e.top),l&&(o.mapSubcontainerEl.style.bottom=p+"px",u+=n-e.bottom),a||l||(o.mapSubcontainerEl.style.top=e.top+"px",u+=c+p),r&&(o.mapSubcontainerEl.style.left=h+"px",g+=e.left),s&&(o.mapSubcontainerEl.style.right=d+"px",g+=t-e.right),r||s||(o.mapSubcontainerEl.style.left=e.left+"px",g+=h+d),o.mapSubcontainerEl.style.height=u+"px",o.mapSubcontainerEl.style.width=g+"px"}else console.warn("[TraveledMap trip] subcontainer is null")},this.sendResizeEvent=function(e,t,n){var i=t,a=n;window.setTimeout((function(){o.mapIframeEl&&o.mapIframeEl.contentWindow?o.mapIframeEl.contentWindow.postMessage({type:e,detail:{extendedShowSteps:i,extendedShowPictures:a}},"*"):console.warn("[TraveledMap trip] iframe or iframe contentWindow is null")}))},this.listenToResizeRequest=function(){window.addEventListener("message",(function(e){e&&e.data&&e.data.type&&"needResize"===e.data.type&&window.setTimeout(o.onResize,500)}))},this.onResize=function(){o.isExtended&&(o.setMapToReducedSize(),o.isExtended=!1,o.setMapSizeToExtendedSize(),o.isExtended=!0)},this.listenToScroll=function(){o.config.isSticky&&window.addEventListener("scroll",(function(){if(o.scrollConfig.shouldListenToScroll){var e=o.config.isOverContent&&o.mapSubcontainerEl?o.mapSubcontainerEl.offsetHeight:0,n=window.pageYOffset;o.scrollConfig.isScrollingDown=n>o.scrollConfig.previousScrollDistance,o.scrollConfig.previousScrollDistance=n;var i=0,a=1e6,s=Array.from(document.getElementsByClassName("traveledmap-trip-step"));if(s.forEach((function(t,n){var o=t.getBoundingClientRect().top-e;Math.abs(o)<Math.abs(a)&&(a=o,i=n)})),200>a){o.scrollConfig.isScrollingDown||a>0&&(i=0===i?0:i-1);var l=s[i].getAttribute("data-step");o.scrollConfig.currentHash!==l&&(t(o.mapIframeEl,l),o.scrollConfig.currentHash=l)}var r=s[0];r&&null!==o.scrollConfig.currentHash&&o.scrollConfig.currentHash===r.getAttribute("data-step")&&r.getBoundingClientRect().top-e>200&&(t(o.mapIframeEl,null),o.scrollConfig.currentHash=null)}}))},this.listenToMapStepClicked=function(){o.config.shouldScrollToStepContentWhenClicked&&window.addEventListener("message",(function(e){if(e.data&&e.data.type&&"onLocationChanged"===e.data.type){o.scrollConfig.shouldListenToScroll=!1;var t=e.data.detail.hash;window.location.hash=t;var n=document.querySelectorAll('[data-step="'+t+'"]')[0];if(!n)return;n.scrollIntoView({block:"start",behavior:"smooth"}),window.setTimeout((function(){o.scrollConfig.shouldListenToScroll=!0}),1e3)}}))},this.mapContainerId=i,this.config=e({},n,a),this.conditionallyCreateMapInDom()&&(this.createSticky(),this.listenToExtendMapToggling(),this.listenToStretchMapToggling(),this.listenToHideMapToggling(),this.listenToResizeRequest(),this.listenToScroll(),this.listenToMapStepClicked(),window.onresize=this.onResize)}var a=i.prototype;return a.conditionallyCreateMapInDom=function(){if(this.mapContainerEl=document.getElementById(this.mapContainerId),!this.mapContainerId||!this.mapContainerEl)return console.error("Error when initializing TraveledMap map: couldn't find element with targetId="+this.mapContainerId),!1;if(this.config.isDisabled)return console.debug("TraveledMap trip won't initiate because it's disabled by the config",{config:this.config}),!1;var e=window.innerWidth;return!this.config.shouldShowOnPhones&&e<768||!this.config.shouldShowOnTablets&&e>=768&&e<992||!this.config.shouldShowOnLargeScreens&&e>=992?(console.debug("TraveledMap trip won't initiate because this kind of device (screen width) has been disabled by the config",{config:this.config}),!1):(this.effectivelyCreateMapInDom(),this.mapSubcontainerEl=this.mapContainerEl.getElementsByClassName("traveledmap-trip-widget-map-container")[0],this.mapIframeEl=this.mapSubcontainerEl.querySelector("iframe"),!0)},a.effectivelyCreateMapInDom=function(){if(this.mapContainerEl){var e=this.getMapUrl();this.mapContainerEl.innerHTML='\n            <div class="traveledmap-trip-widget-wrapper '+(this.config.isStretchable?"is--stretchable":"")+'">\n                <div class="traveledmap-trip-widget-map-container">\n                    <div class="traveledmap-trip-widget-map-content">\n                        <iframe frameborder="0" allow="fullscreen" class="traveledmap-trip-widget-map" src="'+e+'"></iframe>\n                    </div>\n                    '+this.renderActionButtons()+"\n                </div>\n                \n                <style>\n                    .traveledmap-trip-widget-wrapper {\n                        height: "+this.config.mapHeight+";\n                    }\n                    .traveledmap-trip-widget-map-container {\n                        height: "+this.config.mapHeight+";\n                    }\n                    .traveledmap-trip-widget-map-container.is--sticky {\n                        height: "+this.config.stickyMapHeight+";\n                    }\n                    .traveledmap-trip-widget-map-container.is--stretched {\n                        height: "+this.config.stretchedMapHeight+";\n                    }\n                    .traveledmap-trip-widget-map-container.is--hidden {\n                        height: 0;\n                    }\n                </style>\n            </div>\n    "}},a.renderActionButtons=function(){return"\n        "+(this.config.isExtendable||this.config.isStretchable?'\n            <div class="actions-wrapper flex-center">\n                '+(this.config.isExtendable?"\n                <button type=\"button\" onclick=\"document.dispatchEvent(new CustomEvent('traveledmapTripToggleExtendMap', { detail: '"+this.mapContainerId+'\' }))">\n                    <div class="icon extend-icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="expand" class="svg-inline--fa fa-expand fa-w-14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 180V56c0-13.3 10.7-24 24-24h124c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H64v84c0 6.6-5.4 12-12 12H12c-6.6 0-12-5.4-12-12zM288 44v40c0 6.6 5.4 12 12 12h84v84c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12V56c0-13.3-10.7-24-24-24H300c-6.6 0-12 5.4-12 12zm148 276h-40c-6.6 0-12 5.4-12 12v84h-84c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h124c13.3 0 24-10.7 24-24V332c0-6.6-5.4-12-12-12zM160 468v-40c0-6.6-5.4-12-12-12H64v-84c0-6.6-5.4-12-12-12H12c-6.6 0-12 5.4-12 12v124c0 13.3 10.7 24 24 24h124c6.6 0 12-5.4 12-12z"></path></svg></div>\n                </button>\n                ':"")+"\n                "+(this.config.isStretchable?"\n                <button type=\"button\" onclick=\"document.dispatchEvent(new CustomEvent('traveledmapTripToggleHideMap', { detail: '"+this.mapContainerId+'\' }))" class="mr-5">\n                    <div class="icon show-icon"><svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="eye" class="svg-inline--fa fa-eye fa-w-18" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentColor" d="M288 144a110.94 110.94 0 0 0-31.24 5 55.4 55.4 0 0 1 7.24 27 56 56 0 0 1-56 56 55.4 55.4 0 0 1-27-7.24A111.71 111.71 0 1 0 288 144zm284.52 97.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400c-98.65 0-189.09-55-237.93-144C98.91 167 189.34 112 288 112s189.09 55 237.93 144C477.1 345 386.66 400 288 400z"></path></svg></div>\n                    <div class="icon hide-icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="eye-slash" class="svg-inline--fa fa-eye-slash fa-w-20" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M320 400c-75.85 0-137.25-58.71-142.9-133.11L72.2 185.82c-13.79 17.3-26.48 35.59-36.72 55.59a32.35 32.35 0 0 0 0 29.19C89.71 376.41 197.07 448 320 448c26.91 0 52.87-4 77.89-10.46L346 397.39a144.13 144.13 0 0 1-26 2.61zm313.82 58.1l-110.55-85.44a331.25 331.25 0 0 0 81.25-102.07 32.35 32.35 0 0 0 0-29.19C550.29 135.59 442.93 64 320 64a308.15 308.15 0 0 0-147.32 37.7L45.46 3.37A16 16 0 0 0 23 6.18L3.37 31.45A16 16 0 0 0 6.18 53.9l588.36 454.73a16 16 0 0 0 22.46-2.81l19.64-25.27a16 16 0 0 0-2.82-22.45zm-183.72-142l-39.3-30.38A94.75 94.75 0 0 0 416 256a94.76 94.76 0 0 0-121.31-92.21A47.65 47.65 0 0 1 304 192a46.64 46.64 0 0 1-1.54 10l-73.61-56.89A142.31 142.31 0 0 1 320 112a143.92 143.92 0 0 1 144 144c0 21.63-5.29 41.79-13.9 60.11z"></path></svg></div>\n                </button>\n                <button type="button" onclick="document.dispatchEvent(new CustomEvent(\'traveledmapTripToggleStretchMap\', { detail: \''+this.mapContainerId+'\' }))" class="toggle-stretch-button">\n                    <div class="icon stretch-icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="angle-double-down" class="svg-inline--fa fa-angle-double-down fa-w-10" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M143 256.3L7 120.3c-9.4-9.4-9.4-24.6 0-33.9l22.6-22.6c9.4-9.4 24.6-9.4 33.9 0l96.4 96.4 96.4-96.4c9.4-9.4 24.6-9.4 33.9 0L313 86.3c9.4 9.4 9.4 24.6 0 33.9l-136 136c-9.4 9.5-24.6 9.5-34 .1zm34 192l136-136c9.4-9.4 9.4-24.6 0-33.9l-22.6-22.6c-9.4-9.4-24.6-9.4-33.9 0L160 352.1l-96.4-96.4c-9.4-9.4-24.6-9.4-33.9 0L7 278.3c-9.4 9.4-9.4 24.6 0 33.9l136 136c9.4 9.5 24.6 9.5 34 .1z"></path></svg></div>\n                    <div class="icon unstretch-icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="angle-double-up" class="svg-inline--fa fa-angle-double-up fa-w-10" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M177 255.7l136 136c9.4 9.4 9.4 24.6 0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9 0L160 351.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9 0L7 425.7c-9.4-9.4-9.4-24.6 0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1zm-34-192L7 199.7c-9.4 9.4-9.4 24.6 0 33.9l22.6 22.6c9.4 9.4 24.6 9.4 33.9 0l96.4-96.4 96.4 96.4c9.4 9.4 24.6 9.4 33.9 0l22.6-22.6c9.4-9.4 9.4-24.6 0-33.9l-136-136c-9.2-9.4-24.4-9.4-33.8 0z"></path></svg></div>\n                </button>\n                ':"")+"\n            </div>                \n        ":"")+"\n        "},a.getMapUrl=function(){var e="http://localhost:3000/trip/"+this.config.userId+"/"+this.config.tripId+"?isLib=true";return e+="&clusteringRadius=0",e+=this.config.shouldShowSteps?"&showPopup=true":"",e+=this.config.shouldShowPictures?"":"&hidePictures=true",e+=this.config.shouldShowPicturesAtStart?"&showPicturesAtStart=true":"",e+=this.config.isExtendable?"&hideAttr=true":"",(e+=this.config.isExtendable?"&hideZoom=true":"")+(this.config.shouldShowMarkersCustomization?"&customizeMarkers=true":"")},i}();window.TraveledMapTrip=i;
//# sourceMappingURL=traveledmap-trip-lib.cjs.production.min.js.map
